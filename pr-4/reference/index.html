
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../explanation/">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.18">
    
    
      
        <title>Full listing of all docstrings by module - LyoPRONTO Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7e37652d.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#full-listing-of-all-docstrings-by-module" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="LyoPRONTO Documentation" class="md-header__button md-logo" aria-label="LyoPRONTO Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LyoPRONTO Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Full listing of all docstrings by module
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="LyoPRONTO Documentation" class="md-nav__button md-logo" aria-label="LyoPRONTO Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    LyoPRONTO Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LyoPRONTO: Getting Started
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorials
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../how-to-guides/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    How-to Guide
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/knownRp_PD/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    knownRp PD
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/test/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Test
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../explanation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Explanations
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Full listing of all docstrings by module
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Full listing of all docstrings by module
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#lyopronto" class="md-nav__link">
    <span class="md-ellipsis">
      lyopronto
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lyopronto.functions" class="md-nav__link">
    <span class="md-ellipsis">
      functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lyopronto.functions.Eq_Constraints" class="md-nav__link">
    <span class="md-ellipsis">
      Eq_Constraints
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lyopronto.functions.Ineq_Constraints" class="md-nav__link">
    <span class="md-ellipsis">
      Ineq_Constraints
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lyopronto.functions.Kv_FUN" class="md-nav__link">
    <span class="md-ellipsis">
      Kv_FUN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lyopronto.functions.Lpr0_FUN" class="md-nav__link">
    <span class="md-ellipsis">
      Lpr0_FUN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lyopronto.functions.Rp_FUN" class="md-nav__link">
    <span class="md-ellipsis">
      Rp_FUN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lyopronto.functions.Rp_finder" class="md-nav__link">
    <span class="md-ellipsis">
      Rp_finder
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lyopronto.functions.T_bot_FUN" class="md-nav__link">
    <span class="md-ellipsis">
      T_bot_FUN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lyopronto.functions.T_sub_Rp_finder" class="md-nav__link">
    <span class="md-ellipsis">
      T_sub_Rp_finder
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lyopronto.functions.T_sub_fromTpr" class="md-nav__link">
    <span class="md-ellipsis">
      T_sub_fromTpr
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lyopronto.functions.T_sub_solver_FUN" class="md-nav__link">
    <span class="md-ellipsis">
      T_sub_solver_FUN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lyopronto.functions.Tbot_max_eq_cap" class="md-nav__link">
    <span class="md-ellipsis">
      Tbot_max_eq_cap
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lyopronto.functions.Vapor_pressure" class="md-nav__link">
    <span class="md-ellipsis">
      Vapor_pressure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lyopronto.functions.calc_step" class="md-nav__link">
    <span class="md-ellipsis">
      calc_step
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lyopronto.functions.crystallization_time_FUN" class="md-nav__link">
    <span class="md-ellipsis">
      crystallization_time_FUN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lyopronto.functions.fill_output" class="md-nav__link">
    <span class="md-ellipsis">
      fill_output
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lyopronto.functions.lumped_cap_Tpr" class="md-nav__link">
    <span class="md-ellipsis">
      lumped_cap_Tpr
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lyopronto.functions.sub_rate" class="md-nav__link">
    <span class="md-ellipsis">
      sub_rate
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#lyopronto" class="md-nav__link">
    <span class="md-ellipsis">
      lyopronto
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lyopronto.functions" class="md-nav__link">
    <span class="md-ellipsis">
      functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lyopronto.functions.Eq_Constraints" class="md-nav__link">
    <span class="md-ellipsis">
      Eq_Constraints
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lyopronto.functions.Ineq_Constraints" class="md-nav__link">
    <span class="md-ellipsis">
      Ineq_Constraints
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lyopronto.functions.Kv_FUN" class="md-nav__link">
    <span class="md-ellipsis">
      Kv_FUN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lyopronto.functions.Lpr0_FUN" class="md-nav__link">
    <span class="md-ellipsis">
      Lpr0_FUN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lyopronto.functions.Rp_FUN" class="md-nav__link">
    <span class="md-ellipsis">
      Rp_FUN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lyopronto.functions.Rp_finder" class="md-nav__link">
    <span class="md-ellipsis">
      Rp_finder
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lyopronto.functions.T_bot_FUN" class="md-nav__link">
    <span class="md-ellipsis">
      T_bot_FUN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lyopronto.functions.T_sub_Rp_finder" class="md-nav__link">
    <span class="md-ellipsis">
      T_sub_Rp_finder
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lyopronto.functions.T_sub_fromTpr" class="md-nav__link">
    <span class="md-ellipsis">
      T_sub_fromTpr
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lyopronto.functions.T_sub_solver_FUN" class="md-nav__link">
    <span class="md-ellipsis">
      T_sub_solver_FUN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lyopronto.functions.Tbot_max_eq_cap" class="md-nav__link">
    <span class="md-ellipsis">
      Tbot_max_eq_cap
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lyopronto.functions.Vapor_pressure" class="md-nav__link">
    <span class="md-ellipsis">
      Vapor_pressure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lyopronto.functions.calc_step" class="md-nav__link">
    <span class="md-ellipsis">
      calc_step
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lyopronto.functions.crystallization_time_FUN" class="md-nav__link">
    <span class="md-ellipsis">
      crystallization_time_FUN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lyopronto.functions.fill_output" class="md-nav__link">
    <span class="md-ellipsis">
      fill_output
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lyopronto.functions.lumped_cap_Tpr" class="md-nav__link">
    <span class="md-ellipsis">
      lumped_cap_Tpr
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lyopronto.functions.sub_rate" class="md-nav__link">
    <span class="md-ellipsis">
      sub_rate
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="full-listing-of-all-docstrings-by-module">Full listing of all docstrings by module</h1>


<div class="doc doc-object doc-module">



<a id="lyopronto"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">










<div class="doc doc-object doc-module">



<h2 id="lyopronto.functions" class="doc doc-heading">
            <code>functions</code>


</h2>

    <div class="doc doc-contents ">

        <p>File with a bunch of functions in it.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="lyopronto.functions.Eq_Constraints" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">Eq_Constraints</span><span class="p">(</span><span class="n">Pch</span><span class="p">,</span> <span class="n">dmdt</span><span class="p">,</span> <span class="n">Tbot</span><span class="p">,</span> <span class="n">Tsh</span><span class="p">,</span> <span class="n">Psub</span><span class="p">,</span> <span class="n">Tsub</span><span class="p">,</span> <span class="n">Kv</span><span class="p">,</span> <span class="n">Lpr0</span><span class="p">,</span> <span class="n">Lck</span><span class="p">,</span> <span class="n">Av</span><span class="p">,</span> <span class="n">Ap</span><span class="p">,</span> <span class="n">Rp</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Defines the equality constraints for lyophilization. Inputs are chamber pressure in Torr,
sublimation rate in kg/hr, vial bottom temperature in degC, shelf temperature in degC,
sublimation front pressure in Torr, sublimation front temperature in degC, vial heat
transfer coefficient in cal/s/cm^2/C, initial product length in cm, cake length in cm,
vial area in cm^2, product area in cm^2, and product resistance in cm^2-Torr-hr/g</p>


            <details class="quote">
              <summary>Source code in <code>lyopronto\functions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">Eq_Constraints</span><span class="p">(</span><span class="n">Pch</span><span class="p">,</span><span class="n">dmdt</span><span class="p">,</span><span class="n">Tbot</span><span class="p">,</span><span class="n">Tsh</span><span class="p">,</span><span class="n">Psub</span><span class="p">,</span><span class="n">Tsub</span><span class="p">,</span><span class="n">Kv</span><span class="p">,</span><span class="n">Lpr0</span><span class="p">,</span><span class="n">Lck</span><span class="p">,</span><span class="n">Av</span><span class="p">,</span><span class="n">Ap</span><span class="p">,</span><span class="n">Rp</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Defines the equality constraints for lyophilization. Inputs are chamber pressure in Torr,</span>
<span class="sd">    sublimation rate in kg/hr, vial bottom temperature in degC, shelf temperature in degC,</span>
<span class="sd">    sublimation front pressure in Torr, sublimation front temperature in degC, vial heat</span>
<span class="sd">    transfer coefficient in cal/s/cm^2/C, initial product length in cm, cake length in cm,</span>
<span class="sd">    vial area in cm^2, product area in cm^2, and product resistance in cm^2-Torr-hr/g </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">C1</span> <span class="o">=</span> <span class="n">Psub</span> <span class="o">-</span> <span class="mf">2.698e10</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">6144.96</span><span class="o">/</span><span class="p">(</span><span class="mf">273.15</span><span class="o">+</span><span class="n">Tsub</span><span class="p">))</span>   <span class="c1"># Vapor pressure at the sublimation temperature in Torr</span>

    <span class="n">C2</span> <span class="o">=</span> <span class="n">dmdt</span> <span class="o">-</span> <span class="n">Ap</span><span class="o">/</span><span class="n">Rp</span><span class="o">/</span><span class="n">constant</span><span class="o">.</span><span class="n">kg_To_g</span><span class="o">*</span><span class="p">(</span><span class="n">Psub</span><span class="o">-</span><span class="n">Pch</span><span class="p">)</span>  <span class="c1"># Sublimation rate in kg/hr</span>

    <span class="n">C3</span> <span class="o">=</span> <span class="p">(</span><span class="n">Tsh</span><span class="o">-</span><span class="n">Tbot</span><span class="p">)</span><span class="o">*</span><span class="n">Av</span><span class="o">*</span><span class="n">Kv</span><span class="o">*</span><span class="p">(</span><span class="n">Lpr0</span><span class="o">-</span><span class="n">Lck</span><span class="p">)</span> <span class="o">-</span> <span class="n">Ap</span><span class="o">*</span><span class="p">(</span><span class="n">Tbot</span><span class="o">-</span><span class="n">Tsub</span><span class="p">)</span><span class="o">*</span><span class="n">constant</span><span class="o">.</span><span class="n">k_ice</span>  <span class="c1"># Vial heat transfer balance</span>

    <span class="n">C4</span> <span class="o">=</span> <span class="n">Tsh</span> <span class="o">-</span> <span class="n">dmdt</span><span class="o">*</span><span class="n">constant</span><span class="o">.</span><span class="n">kg_To_g</span><span class="o">/</span><span class="n">constant</span><span class="o">.</span><span class="n">hr_To_s</span><span class="o">*</span><span class="n">constant</span><span class="o">.</span><span class="n">dHs</span><span class="o">/</span><span class="n">Av</span><span class="o">/</span><span class="n">Kv</span> <span class="o">-</span> <span class="n">Tbot</span>  <span class="c1"># Shelf temperature in C</span>

    <span class="k">return</span> <span class="n">C1</span><span class="p">,</span><span class="n">C2</span><span class="p">,</span><span class="n">C3</span><span class="p">,</span><span class="n">C4</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="lyopronto.functions.Ineq_Constraints" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">Ineq_Constraints</span><span class="p">(</span><span class="n">Pch</span><span class="p">,</span> <span class="n">dm_dt</span><span class="p">,</span> <span class="n">Tcrit</span><span class="p">,</span> <span class="n">Tbot</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">nVial</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Defines the inequality constraints for lyophilization optimization within
safe operation region inside the desgin space. Inputs are chamber pressure in Torr,
sublimation rate in kg/hr, critical product temperature in degC, vial bottom
temperature in degC, equipment capability parameters a in kg/hr and b in kg/hr/Torr,
and number of vials</p>


            <details class="quote">
              <summary>Source code in <code>lyopronto\functions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">Ineq_Constraints</span><span class="p">(</span><span class="n">Pch</span><span class="p">,</span><span class="n">dm_dt</span><span class="p">,</span><span class="n">Tcrit</span><span class="p">,</span><span class="n">Tbot</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">nVial</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Defines the inequality constraints for lyophilization optimization within</span>
<span class="sd">    safe operation region inside the desgin space. Inputs are chamber pressure in Torr,</span>
<span class="sd">    sublimation rate in kg/hr, critical product temperature in degC, vial bottom</span>
<span class="sd">    temperature in degC, equipment capability parameters a in kg/hr and b in kg/hr/Torr,</span>
<span class="sd">    and number of vials</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">C1</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">Pch</span> <span class="o">-</span> <span class="n">nVial</span><span class="o">*</span><span class="n">dm_dt</span>	<span class="c1"># Equipment capability limit</span>

    <span class="n">C2</span> <span class="o">=</span> <span class="n">Tcrit</span> <span class="o">-</span> <span class="n">Tbot</span>		<span class="c1"># Maximum product temperature limit</span>

    <span class="k">return</span> <span class="n">C1</span><span class="p">,</span><span class="n">C2</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="lyopronto.functions.Kv_FUN" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">Kv_FUN</span><span class="p">(</span><span class="n">KC</span><span class="p">,</span> <span class="n">KP</span><span class="p">,</span> <span class="n">KD</span><span class="p">,</span> <span class="n">Pch</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Calculates the vial heat transfer coefficient.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>KC</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Vial heat transfer parameter in cal/s/K/cm^2.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>KP</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Vial heat transfer parameter in cal/s/K/cm^2/Torr.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>KD</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Vial heat transfer parameter in 1/Torr.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>Pch</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Chamber pressure in Torr.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Vial heat transfer coefficient in cal/s/K/cm^2.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>lyopronto\functions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">Kv_FUN</span><span class="p">(</span><span class="n">KC</span><span class="p">,</span><span class="n">KP</span><span class="p">,</span><span class="n">KD</span><span class="p">,</span><span class="n">Pch</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates the vial heat transfer coefficient.</span>

<span class="sd">    Args:</span>
<span class="sd">        KC (float): Vial heat transfer parameter in cal/s/K/cm^2.</span>
<span class="sd">        KP (float): Vial heat transfer parameter in cal/s/K/cm^2/Torr.</span>
<span class="sd">        KD (float): Vial heat transfer parameter in 1/Torr.</span>
<span class="sd">        Pch (float): Chamber pressure in Torr.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (float): Vial heat transfer coefficient in cal/s/K/cm^2.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">KC</span> <span class="o">+</span> <span class="n">KP</span><span class="o">*</span><span class="n">Pch</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0</span><span class="o">+</span><span class="n">KD</span><span class="o">*</span><span class="n">Pch</span><span class="p">)</span> <span class="c1"># Kv in cal/s/K/cm^2</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="lyopronto.functions.Lpr0_FUN" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">Lpr0_FUN</span><span class="p">(</span><span class="n">Vfill</span><span class="p">,</span> <span class="n">Ap</span><span class="p">,</span> <span class="n">cSolid</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Calculates the intial fill height of the frozen product in cm. </p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>Vfill</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>fill volume in mL</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>Ap</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>product area in cm^2</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cSolid</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>fractional concentration of the solute in solution</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>initial fill height of the frozen product, in cm.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>lyopronto\functions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">Lpr0_FUN</span><span class="p">(</span><span class="n">Vfill</span><span class="p">,</span><span class="n">Ap</span><span class="p">,</span><span class="n">cSolid</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates the intial fill height of the frozen product in cm. </span>

<span class="sd">    Args:</span>
<span class="sd">        Vfill (float): fill volume in mL</span>
<span class="sd">        Ap (float): product area in cm^2</span>
<span class="sd">        cSolid (float): fractional concentration of the solute in solution</span>

<span class="sd">    Returns:</span>
<span class="sd">        (float): initial fill height of the frozen product, in cm.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">dens_fac</span> <span class="o">=</span> <span class="p">(</span><span class="n">constant</span><span class="o">.</span><span class="n">rho_solution</span><span class="o">-</span><span class="n">cSolid</span><span class="o">*</span><span class="p">(</span><span class="n">constant</span><span class="o">.</span><span class="n">rho_solution</span><span class="o">-</span><span class="n">constant</span><span class="o">.</span><span class="n">rho_ice</span><span class="p">)</span><span class="o">/</span><span class="n">constant</span><span class="o">.</span><span class="n">rho_solute</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Vfill</span><span class="o">/</span><span class="p">(</span><span class="n">Ap</span><span class="o">*</span><span class="n">constant</span><span class="o">.</span><span class="n">rho_ice</span><span class="p">)</span><span class="o">*</span><span class="n">dens_fac</span>  <span class="c1"># Fill height in cm</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="lyopronto.functions.Rp_FUN" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">Rp_FUN</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">R0</span><span class="p">,</span> <span class="n">A1</span><span class="p">,</span> <span class="n">A2</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Calculates product resistance in cm^2-hr-Torr/g.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>l</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>cake length in cm</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>R0</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>base product resistance in cm^2-hr-Torr/g</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>A1</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>product resistance parameter in cm-hr-Torr/g</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>A2</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>product resistance parameter in 1/cm</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>product resistance in cm^2-hr-Torr/g</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>lyopronto\functions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">Rp_FUN</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">R0</span><span class="p">,</span><span class="n">A1</span><span class="p">,</span><span class="n">A2</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates product resistance in cm^2-hr-Torr/g.</span>

<span class="sd">    Args:</span>
<span class="sd">        l (float): cake length in cm</span>
<span class="sd">        R0 (float): base product resistance in cm^2-hr-Torr/g</span>
<span class="sd">        A1 (float): product resistance parameter in cm-hr-Torr/g</span>
<span class="sd">        A2 (float): product resistance parameter in 1/cm</span>

<span class="sd">    Returns:</span>
<span class="sd">        (float): product resistance in cm^2-hr-Torr/g</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">R0</span> <span class="o">+</span> <span class="n">A1</span><span class="o">*</span><span class="n">l</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">A2</span><span class="o">*</span><span class="n">l</span><span class="p">)</span> <span class="c1"># Product resistance in cm^2-hr-Torr/g</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="lyopronto.functions.Rp_finder" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">Rp_finder</span><span class="p">(</span><span class="n">T_sub</span><span class="p">,</span> <span class="n">Lpr0</span><span class="p">,</span> <span class="n">Lck</span><span class="p">,</span> <span class="n">Pch</span><span class="p">,</span> <span class="n">Tbot</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Calculates product resistance in cm^2-hr-Torr/g. Inputs are sublimation
temperature in degC, initial product length in cm, cake length in cm,
chamber pressure in Torr, and vial bottom temperature in degC</p>


            <details class="quote">
              <summary>Source code in <code>lyopronto\functions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">Rp_finder</span><span class="p">(</span><span class="n">T_sub</span><span class="p">,</span><span class="n">Lpr0</span><span class="p">,</span><span class="n">Lck</span><span class="p">,</span><span class="n">Pch</span><span class="p">,</span><span class="n">Tbot</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates product resistance in cm^2-hr-Torr/g. Inputs are sublimation</span>
<span class="sd">    temperature in degC, initial product length in cm, cake length in cm,</span>
<span class="sd">    chamber pressure in Torr, and vial bottom temperature in degC</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">P_sub</span> <span class="o">=</span> <span class="n">Vapor_pressure</span><span class="p">(</span><span class="n">T_sub</span><span class="p">)</span>   <span class="c1"># Vapor pressure at the sublimation temperature in Torr</span>

    <span class="n">Rp</span> <span class="o">=</span> <span class="p">(</span><span class="n">Lpr0</span><span class="o">-</span><span class="n">Lck</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">P_sub</span><span class="o">-</span><span class="n">Pch</span><span class="p">)</span><span class="o">*</span><span class="n">constant</span><span class="o">.</span><span class="n">dHs</span><span class="o">/</span><span class="p">(</span><span class="n">Tbot</span><span class="o">-</span><span class="n">T_sub</span><span class="p">)</span><span class="o">/</span><span class="n">constant</span><span class="o">.</span><span class="n">hr_To_s</span><span class="o">/</span><span class="n">constant</span><span class="o">.</span><span class="n">k_ice</span>	<span class="c1"># Product resistance in cm^2-Torr-hr/g</span>

    <span class="k">return</span> <span class="n">Rp</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="lyopronto.functions.T_bot_FUN" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">T_bot_FUN</span><span class="p">(</span><span class="n">T_sub</span><span class="p">,</span> <span class="n">Lpr0</span><span class="p">,</span> <span class="n">Lck</span><span class="p">,</span> <span class="n">Pch</span><span class="p">,</span> <span class="n">Rp</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Calculates the temperature at the bottom of the vial in degC. Inputs are
sublimation front temperature in degC, initial product length in cm, cake
length in cm, chamber pressure in Torr, and product resistance in
cm^2-Torr-hr/g</p>


            <details class="quote">
              <summary>Source code in <code>lyopronto\functions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">T_bot_FUN</span><span class="p">(</span><span class="n">T_sub</span><span class="p">,</span><span class="n">Lpr0</span><span class="p">,</span><span class="n">Lck</span><span class="p">,</span><span class="n">Pch</span><span class="p">,</span><span class="n">Rp</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the temperature at the bottom of the vial in degC. Inputs are</span>
<span class="sd">    sublimation front temperature in degC, initial product length in cm, cake</span>
<span class="sd">    length in cm, chamber pressure in Torr, and product resistance in</span>
<span class="sd">    cm^2-Torr-hr/g</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">P_sub</span> <span class="o">=</span> <span class="n">Vapor_pressure</span><span class="p">(</span><span class="n">T_sub</span><span class="p">)</span>   <span class="c1"># Vapor pressure at the sublimation temperature in Torr</span>

    <span class="n">Tbot</span> <span class="o">=</span> <span class="n">T_sub</span> <span class="o">+</span> <span class="p">(</span><span class="n">Lpr0</span><span class="o">-</span><span class="n">Lck</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">P_sub</span><span class="o">-</span><span class="n">Pch</span><span class="p">)</span><span class="o">*</span><span class="n">constant</span><span class="o">.</span><span class="n">dHs</span><span class="o">/</span><span class="n">Rp</span><span class="o">/</span><span class="n">constant</span><span class="o">.</span><span class="n">hr_To_s</span><span class="o">/</span><span class="n">constant</span><span class="o">.</span><span class="n">k_ice</span> <span class="c1"># Vial bottom temperature in degC</span>

    <span class="k">return</span> <span class="n">Tbot</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="lyopronto.functions.T_sub_Rp_finder" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">T_sub_Rp_finder</span><span class="p">(</span><span class="n">T_sub</span><span class="p">,</span> <span class="o">*</span><span class="n">data</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Tsub is found from solving for T_unknown.
Determines the function to calculate the sublimation temperature
represented as T_unknown. Other inputs are chamber pressure in Torr, vial
area in cm^2, product area in cm^2, vial heat transfer coefficient in
cal/s/K/cm^2, initial product length in cm, cake length in cm, vial bottom 
temperature in degC, and shelf temperature in degC</p>


            <details class="quote">
              <summary>Source code in <code>lyopronto\functions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">T_sub_Rp_finder</span><span class="p">(</span><span class="n">T_sub</span><span class="p">,</span> <span class="o">*</span><span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tsub is found from solving for T_unknown.</span>
<span class="sd">    Determines the function to calculate the sublimation temperature</span>
<span class="sd">    represented as T_unknown. Other inputs are chamber pressure in Torr, vial</span>
<span class="sd">    area in cm^2, product area in cm^2, vial heat transfer coefficient in</span>
<span class="sd">    cal/s/K/cm^2, initial product length in cm, cake length in cm, vial bottom </span>
<span class="sd">    temperature in degC, and shelf temperature in degC</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">Av</span><span class="p">,</span> <span class="n">Ap</span><span class="p">,</span> <span class="n">Kv</span><span class="p">,</span> <span class="n">Lpr0</span><span class="p">,</span> <span class="n">Lck</span><span class="p">,</span> <span class="n">Tbot</span><span class="p">,</span> <span class="n">Tsh</span> <span class="o">=</span> <span class="n">data</span>

    <span class="n">LHS</span> <span class="o">=</span> <span class="p">(</span><span class="n">Tsh</span> <span class="o">-</span> <span class="n">Tbot</span><span class="p">)</span><span class="o">*</span><span class="n">Av</span><span class="o">*</span><span class="n">Kv</span>
    <span class="n">RHS</span> <span class="o">=</span> <span class="p">(</span><span class="n">Tbot</span> <span class="o">-</span> <span class="n">T_sub</span><span class="p">)</span><span class="o">*</span><span class="n">Ap</span><span class="o">*</span><span class="n">constant</span><span class="o">.</span><span class="n">k_ice</span><span class="o">/</span><span class="p">(</span><span class="n">Lpr0</span><span class="o">-</span><span class="n">Lck</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">LHS</span><span class="o">-</span><span class="n">RHS</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="lyopronto.functions.T_sub_fromTpr" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">T_sub_fromTpr</span><span class="p">(</span><span class="n">T_unknown</span><span class="p">,</span> <span class="o">*</span><span class="n">data</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Tsub is found from solving for T_unknown.  # Determines the function to calculate the sublimation temperature
represented as T_unknown. Other inputs are vial bottom temperature in degC, 
initial product length in cm, cake length in cm, chamber pressure in Torr,
and product resistance in cm^2-Torr-hr/g</p>


            <details class="quote">
              <summary>Source code in <code>lyopronto\functions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">T_sub_fromTpr</span><span class="p">(</span><span class="n">T_unknown</span><span class="p">,</span> <span class="o">*</span><span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tsub is found from solving for T_unknown.  # Determines the function to calculate the sublimation temperature</span>
<span class="sd">    represented as T_unknown. Other inputs are vial bottom temperature in degC, </span>
<span class="sd">    initial product length in cm, cake length in cm, chamber pressure in Torr,</span>
<span class="sd">    and product resistance in cm^2-Torr-hr/g</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">Tbot</span><span class="p">,</span> <span class="n">Lpr0</span><span class="p">,</span> <span class="n">Lck</span><span class="p">,</span> <span class="n">Pch</span><span class="p">,</span> <span class="n">Rp</span> <span class="o">=</span> <span class="n">data</span>

    <span class="n">P_sub</span> <span class="o">=</span> <span class="n">Vapor_pressure</span><span class="p">(</span><span class="n">T_unknown</span><span class="p">)</span>   <span class="c1"># Vapor pressure at the sublimation temperature in Torr</span>

    <span class="n">F</span> <span class="o">=</span> <span class="n">T_unknown</span> <span class="o">-</span> <span class="n">Tbot</span> <span class="o">+</span> <span class="p">(</span><span class="n">P_sub</span><span class="o">-</span><span class="n">Pch</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Lpr0</span><span class="o">-</span><span class="n">Lck</span><span class="p">)</span><span class="o">*</span><span class="n">constant</span><span class="o">.</span><span class="n">dHs</span><span class="o">/</span><span class="n">Rp</span><span class="o">/</span><span class="n">constant</span><span class="o">.</span><span class="n">hr_To_s</span><span class="o">/</span><span class="n">constant</span><span class="o">.</span><span class="n">k_ice</span>  <span class="c1"># Heat and mass transfer energy balance function - Should be zero</span>

    <span class="k">return</span> <span class="n">F</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="lyopronto.functions.T_sub_solver_FUN" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">T_sub_solver_FUN</span><span class="p">(</span><span class="n">T_sub_guess</span><span class="p">,</span> <span class="o">*</span><span class="n">data</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Tsub is found from solving for T_unknown.
Determines the function to calculate the sublimation temperature
represented as T_unknown. Other inputs are chamber pressure in Torr, vial
area in cm^2, product area in cm^2, vial heat transfer coefficient in
cal/s/K/cm^2, initial product length in cm, cake length in cm, product
resistance in cm^2-Torr-hr/g, and shelf temperature in degC</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>T_sub_guess</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initial guess for the sublimation temperature in degC.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Pch, Av, Ap, Kv, Lpr0, Lck, Rp, Tsh</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>residual for the pseudosteady heat balance</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>lyopronto\functions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">T_sub_solver_FUN</span><span class="p">(</span><span class="n">T_sub_guess</span><span class="p">,</span> <span class="o">*</span><span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Tsub is found from solving for T_unknown.</span>
<span class="sd">    Determines the function to calculate the sublimation temperature</span>
<span class="sd">    represented as T_unknown. Other inputs are chamber pressure in Torr, vial</span>
<span class="sd">    area in cm^2, product area in cm^2, vial heat transfer coefficient in</span>
<span class="sd">    cal/s/K/cm^2, initial product length in cm, cake length in cm, product</span>
<span class="sd">    resistance in cm^2-Torr-hr/g, and shelf temperature in degC</span>

<span class="sd">    Args:</span>
<span class="sd">        T_sub_guess (float): Initial guess for the sublimation temperature in degC.</span>
<span class="sd">        data (tuple): Pch, Av, Ap, Kv, Lpr0, Lck, Rp, Tsh</span>

<span class="sd">    Returns:</span>
<span class="sd">        (float): residual for the pseudosteady heat balance</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">Pch</span><span class="p">,</span> <span class="n">Av</span><span class="p">,</span> <span class="n">Ap</span><span class="p">,</span> <span class="n">Kv</span><span class="p">,</span> <span class="n">Lpr0</span><span class="p">,</span> <span class="n">Lck</span><span class="p">,</span> <span class="n">Rp</span><span class="p">,</span> <span class="n">Tsh</span> <span class="o">=</span> <span class="n">data</span>

    <span class="n">P_sub</span> <span class="o">=</span> <span class="n">Vapor_pressure</span><span class="p">(</span><span class="n">T_sub_guess</span><span class="p">)</span>   <span class="c1"># Vapor pressure at the sublimation temperature in Torr</span>
    <span class="n">Qsub</span> <span class="o">=</span> <span class="n">constant</span><span class="o">.</span><span class="n">dHs</span><span class="o">*</span><span class="p">(</span><span class="n">P_sub</span><span class="o">-</span><span class="n">Pch</span><span class="p">)</span><span class="o">*</span><span class="n">Ap</span><span class="o">/</span><span class="n">Rp</span> <span class="o">/</span><span class="n">constant</span><span class="o">.</span><span class="n">hr_To_s</span> <span class="c1"># Sublimation heat</span>
    <span class="n">T_b</span> <span class="o">=</span> <span class="n">T_sub_guess</span> <span class="o">+</span> <span class="n">Qsub</span><span class="o">/</span><span class="n">Ap</span><span class="o">/</span><span class="n">constant</span><span class="o">.</span><span class="n">k_ice</span><span class="o">*</span><span class="p">(</span><span class="n">Lpr0</span><span class="o">-</span><span class="n">Lck</span><span class="p">)</span> <span class="c1"># Corresponding bottom temperature</span>
    <span class="n">Qsh</span> <span class="o">=</span> <span class="n">Kv</span><span class="o">*</span><span class="n">Av</span><span class="o">*</span><span class="p">(</span><span class="n">Tsh</span> <span class="o">-</span> <span class="n">T_b</span><span class="p">)</span> <span class="c1"># Heat transfer from shelf</span>
    <span class="k">return</span> <span class="n">Qsub</span><span class="o">-</span><span class="n">Qsh</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="lyopronto.functions.Tbot_max_eq_cap" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">Tbot_max_eq_cap</span><span class="p">(</span><span class="n">Pch</span><span class="p">,</span> <span class="n">dm_dt</span><span class="p">,</span> <span class="n">Lpr0</span><span class="p">,</span> <span class="n">Lck</span><span class="p">,</span> <span class="n">Rp</span><span class="p">,</span> <span class="n">Ap</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Calculates the maximum product temperature (occus at vial bottom) in
degC. Inputs are chamber pressure in Torr, sublimation rate based on
equipment capability in kg/hr, initial product length in cm, cake length
in cm, product resistance in cm^2-Torr-hr/g, and product area in cm^2</p>


            <details class="quote">
              <summary>Source code in <code>lyopronto\functions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">Tbot_max_eq_cap</span><span class="p">(</span><span class="n">Pch</span><span class="p">,</span><span class="n">dm_dt</span><span class="p">,</span><span class="n">Lpr0</span><span class="p">,</span><span class="n">Lck</span><span class="p">,</span><span class="n">Rp</span><span class="p">,</span><span class="n">Ap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the maximum product temperature (occus at vial bottom) in</span>
<span class="sd">    degC. Inputs are chamber pressure in Torr, sublimation rate based on</span>
<span class="sd">    equipment capability in kg/hr, initial product length in cm, cake length</span>
<span class="sd">    in cm, product resistance in cm^2-Torr-hr/g, and product area in cm^2</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">P_sub</span> <span class="o">=</span> <span class="n">dm_dt</span><span class="o">/</span><span class="n">Ap</span><span class="o">*</span><span class="n">Rp</span> <span class="o">+</span> <span class="n">Pch</span>     <span class="c1"># Sublimation front pressure in Torr</span>
    <span class="n">T_sub</span> <span class="o">=</span> <span class="o">-</span><span class="mf">6144.96</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">P_sub</span><span class="o">/</span><span class="mf">2.698e10</span><span class="p">)</span> <span class="o">-</span> <span class="mf">273.15</span>    <span class="c1"># Sublimation front temperature in degC</span>
    <span class="n">Tbot</span> <span class="o">=</span> <span class="n">T_sub</span> <span class="o">+</span> <span class="p">(</span><span class="n">Lpr0</span><span class="o">-</span><span class="n">Lck</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">P_sub</span><span class="o">-</span><span class="n">Pch</span><span class="p">)</span><span class="o">*</span><span class="n">constant</span><span class="o">.</span><span class="n">dHs</span><span class="o">/</span><span class="n">Rp</span><span class="o">/</span><span class="n">constant</span><span class="o">.</span><span class="n">hr_To_s</span><span class="o">/</span><span class="n">constant</span><span class="o">.</span><span class="n">k_ice</span>	<span class="c1">#Vial bottom temperature in degC</span>
    <span class="n">Tbot_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">Tbot</span><span class="p">)</span>   <span class="c1"># Maximum vial bottom temperature in degC</span>

    <span class="k">return</span> <span class="n">Tbot_max</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="lyopronto.functions.Vapor_pressure" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">Vapor_pressure</span><span class="p">(</span><span class="n">T_sub</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Calculates the vapor pressure in Torr. Input is sublimation front
temperature in degC</p>


            <details class="quote">
              <summary>Source code in <code>lyopronto\functions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">Vapor_pressure</span><span class="p">(</span><span class="n">T_sub</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the vapor pressure in Torr. Input is sublimation front</span>
<span class="sd">    temperature in degC</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">p</span> <span class="o">=</span> <span class="mf">2.698e10</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">6144.96</span><span class="o">/</span><span class="p">(</span><span class="mf">273.15</span><span class="o">+</span><span class="n">T_sub</span><span class="p">))</span>   <span class="c1"># Vapor pressure at the sublimation temperature in Torr</span>

    <span class="k">return</span> <span class="n">p</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="lyopronto.functions.calc_step" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calc_step</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Lck</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Calculate the full set of system states at a given time step from ODE solution states.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>t</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The current time in hours.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>Lck</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The cake thickness in cm.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple containing the configuration parameters.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The full set of system states at the given time step.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>lyopronto\functions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calc_step</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Lck</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the full set of system states at a given time step from ODE solution states.</span>

<span class="sd">    Args:</span>
<span class="sd">        t (float): The current time in hours.</span>
<span class="sd">        Lck (float): The cake thickness in cm.</span>
<span class="sd">        config (tuple): A tuple containing the configuration parameters.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (np.ndarray): The full set of system states at the given time step.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">vial</span><span class="p">,</span> <span class="n">product</span><span class="p">,</span> <span class="n">ht</span><span class="p">,</span> <span class="n">Pch_t</span><span class="p">,</span> <span class="n">Tsh_t</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">Lpr0</span> <span class="o">=</span> <span class="n">config</span>
    <span class="n">Tsh</span> <span class="o">=</span> <span class="n">Tsh_t</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="n">Pch</span> <span class="o">=</span> <span class="n">Pch_t</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="n">Kv</span> <span class="o">=</span> <span class="n">Kv_FUN</span><span class="p">(</span><span class="n">ht</span><span class="p">[</span><span class="s1">&#39;KC&#39;</span><span class="p">],</span><span class="n">ht</span><span class="p">[</span><span class="s1">&#39;KP&#39;</span><span class="p">],</span><span class="n">ht</span><span class="p">[</span><span class="s1">&#39;KD&#39;</span><span class="p">],</span><span class="n">Pch</span><span class="p">)</span>  <span class="c1"># Vial heat transfer coefficient in cal/s/K/cm^2</span>
    <span class="n">Rp</span> <span class="o">=</span> <span class="n">Rp_FUN</span><span class="p">(</span><span class="n">Lck</span><span class="p">,</span><span class="n">product</span><span class="p">[</span><span class="s1">&#39;R0&#39;</span><span class="p">],</span><span class="n">product</span><span class="p">[</span><span class="s1">&#39;A1&#39;</span><span class="p">],</span><span class="n">product</span><span class="p">[</span><span class="s1">&#39;A2&#39;</span><span class="p">])</span>  <span class="c1"># Product resistance in cm^2-hr-Torr/g</span>
    <span class="n">Tsub</span> <span class="o">=</span> <span class="n">fsolve</span><span class="p">(</span><span class="n">T_sub_solver_FUN</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">Pch</span><span class="p">,</span><span class="n">vial</span><span class="p">[</span><span class="s1">&#39;Av&#39;</span><span class="p">],</span><span class="n">vial</span><span class="p">[</span><span class="s1">&#39;Ap&#39;</span><span class="p">],</span><span class="n">Kv</span><span class="p">,</span><span class="n">Lpr0</span><span class="p">,</span><span class="n">Lck</span><span class="p">,</span><span class="n">Rp</span><span class="p">,</span><span class="n">Tsh</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># Sublimation front temperature array in degC</span>
    <span class="n">dmdt</span> <span class="o">=</span> <span class="n">sub_rate</span><span class="p">(</span><span class="n">vial</span><span class="p">[</span><span class="s1">&#39;Ap&#39;</span><span class="p">],</span><span class="n">Rp</span><span class="p">,</span><span class="n">Tsub</span><span class="p">,</span><span class="n">Pch</span><span class="p">)</span>   <span class="c1"># Total sublimation rate array in kg/hr</span>
    <span class="k">if</span> <span class="n">dmdt</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
        <span class="c1"># print(&quot;Shelf temperature is too low for sublimation.&quot;)</span>
        <span class="n">dmdt</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">Tbot</span> <span class="o">=</span> <span class="n">T_bot_FUN</span><span class="p">(</span><span class="n">Tsub</span><span class="p">,</span><span class="n">Lpr0</span><span class="p">,</span><span class="n">Lck</span><span class="p">,</span><span class="n">Pch</span><span class="p">,</span><span class="n">Rp</span><span class="p">)</span>    <span class="c1"># Vial bottom temperature array in degC</span>
    <span class="n">dry_frac</span> <span class="o">=</span> <span class="n">Lck</span><span class="o">/</span><span class="n">Lpr0</span>

    <span class="n">col</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">t</span><span class="p">,</span> <span class="n">Tsub</span><span class="p">,</span> <span class="n">Tbot</span><span class="p">,</span> <span class="n">Tsh</span><span class="p">,</span> <span class="n">Pch</span><span class="o">*</span><span class="n">constant</span><span class="o">.</span><span class="n">Torr_to_mTorr</span><span class="p">,</span> <span class="n">dmdt</span><span class="o">/</span><span class="p">(</span><span class="n">vial</span><span class="p">[</span><span class="s1">&#39;Ap&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">constant</span><span class="o">.</span><span class="n">cm_To_m</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">dry_frac</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">col</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="lyopronto.functions.crystallization_time_FUN" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">crystallization_time_FUN</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">Av</span><span class="p">,</span> <span class="n">Tf</span><span class="p">,</span> <span class="n">Tn</span><span class="p">,</span> <span class="n">Tsh</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Calculates the crystallization time in hr. Inputs are fill volume in mL, heat transfer coefficient in W/m^2/K, vial area in cm^2, freezing temperature in degC, nucleation temperature in degC, shelf temperature in degC</p>


            <details class="quote">
              <summary>Source code in <code>lyopronto\functions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">crystallization_time_FUN</span><span class="p">(</span><span class="n">V</span><span class="p">,</span><span class="n">h</span><span class="p">,</span><span class="n">Av</span><span class="p">,</span><span class="n">Tf</span><span class="p">,</span><span class="n">Tn</span><span class="p">,</span><span class="n">Tsh</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the crystallization time in hr. Inputs are fill volume in mL, heat transfer coefficient in W/m^2/K, vial area in cm^2, freezing temperature in degC, nucleation temperature in degC, shelf temperature in degC</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">F</span> <span class="o">=</span> <span class="n">constant</span><span class="o">.</span><span class="n">rho_solution</span><span class="o">*</span><span class="n">V</span><span class="o">*</span><span class="p">(</span><span class="n">constant</span><span class="o">.</span><span class="n">dHf</span><span class="o">*</span><span class="n">constant</span><span class="o">.</span><span class="n">cal_To_J</span><span class="o">-</span><span class="n">constant</span><span class="o">.</span><span class="n">Cp_solution</span><span class="o">/</span><span class="n">constant</span><span class="o">.</span><span class="n">kg_To_g</span><span class="o">*</span><span class="p">(</span><span class="n">Tf</span><span class="o">-</span><span class="n">Tn</span><span class="p">))</span><span class="o">/</span><span class="n">h</span><span class="o">/</span><span class="n">constant</span><span class="o">.</span><span class="n">hr_To_s</span><span class="o">/</span><span class="n">Av</span><span class="o">/</span><span class="n">constant</span><span class="o">.</span><span class="n">cm_To_m</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">Tf</span><span class="o">-</span><span class="n">Tsh</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">F</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="lyopronto.functions.fill_output" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fill_output</span><span class="p">(</span><span class="n">sol</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Fill the output array with the results from the ODE solver.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>sol</code>
            </td>
            <td>
                  <code><span title="ODESolution">ODESolution</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The solution object returned by the ODE solver.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple containing the configuration parameters.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The output array filled with the results from the ODE solver.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>lyopronto\functions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">fill_output</span><span class="p">(</span><span class="n">sol</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fill the output array with the results from the ODE solver.</span>

<span class="sd">    Args:</span>
<span class="sd">        sol (ODESolution): The solution object returned by the ODE solver.</span>
<span class="sd">        config (tuple): A tuple containing the configuration parameters.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (np.ndarray): The output array filled with the results from the ODE solver.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">vial</span><span class="p">,</span> <span class="n">product</span><span class="p">,</span> <span class="n">ht</span><span class="p">,</span> <span class="n">Pchamber</span><span class="p">,</span> <span class="n">Tshelf</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">Lpr0</span> <span class="o">=</span> <span class="n">config</span>
    <span class="c1"># out_t = np.arange(0, sol.t[-1], dt)   </span>
    <span class="n">out_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sol</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>   
    <span class="n">fullout</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">out_t</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">calc_step</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">config</span><span class="p">))))</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">out_t</span><span class="p">):</span>
        <span class="n">fullout</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">calc_step</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">sol</span><span class="o">.</span><span class="n">sol</span><span class="p">(</span><span class="n">t</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">config</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fullout</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="lyopronto.functions.lumped_cap_Tpr" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">lumped_cap_Tpr</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Tpr0</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">Cp</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">Av</span><span class="p">,</span> <span class="n">Tsh</span><span class="p">,</span> <span class="n">Tsh0</span><span class="p">,</span> <span class="n">Tsh_ramp</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Calculates the product temperature in C. Inputs are time in hr, initial product temperature in degC, product density in g/mL, constant pressure specific heat of the product in J/kg/K, product volume in mL, heat transfer coefficient in W/m^2/K, vial area in cm^2, current shelf temperature in degC, initial shelf temperature in degC, shelf temperature ramping rate in degC/min</p>


            <details class="quote">
              <summary>Source code in <code>lyopronto\functions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">lumped_cap_Tpr</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">Tpr0</span><span class="p">,</span><span class="n">rho</span><span class="p">,</span><span class="n">Cp</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">h</span><span class="p">,</span><span class="n">Av</span><span class="p">,</span><span class="n">Tsh</span><span class="p">,</span><span class="n">Tsh0</span><span class="p">,</span> <span class="n">Tsh_ramp</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the product temperature in C. Inputs are time in hr, initial product temperature in degC, product density in g/mL, constant pressure specific heat of the product in J/kg/K, product volume in mL, heat transfer coefficient in W/m^2/K, vial area in cm^2, current shelf temperature in degC, initial shelf temperature in degC, shelf temperature ramping rate in degC/min</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">F</span> <span class="o">=</span> <span class="p">(</span><span class="n">Tpr0</span> <span class="o">+</span> <span class="n">Tsh_ramp</span><span class="o">/</span><span class="n">constant</span><span class="o">.</span><span class="n">min_To_s</span><span class="o">*</span><span class="n">rho</span><span class="o">*</span><span class="n">Cp</span><span class="o">/</span><span class="n">constant</span><span class="o">.</span><span class="n">kg_To_g</span><span class="o">*</span><span class="n">V</span><span class="o">/</span><span class="n">h</span><span class="o">/</span><span class="n">Av</span><span class="o">/</span><span class="n">constant</span><span class="o">.</span><span class="n">cm_To_m</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">Tsh0</span><span class="p">)</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">h</span><span class="o">*</span><span class="n">Av</span><span class="o">*</span><span class="n">constant</span><span class="o">.</span><span class="n">cm_To_m</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">constant</span><span class="o">.</span><span class="n">hr_To_s</span><span class="o">/</span><span class="n">rho</span><span class="o">/</span><span class="n">Cp</span><span class="o">*</span><span class="n">constant</span><span class="o">.</span><span class="n">kg_To_g</span><span class="o">/</span><span class="n">V</span><span class="p">)</span> <span class="o">-</span> <span class="n">Tsh_ramp</span><span class="o">/</span><span class="n">constant</span><span class="o">.</span><span class="n">min_To_s</span><span class="o">*</span><span class="n">rho</span><span class="o">*</span><span class="n">Cp</span><span class="o">/</span><span class="n">constant</span><span class="o">.</span><span class="n">kg_To_g</span><span class="o">*</span><span class="n">V</span><span class="o">/</span><span class="n">h</span><span class="o">/</span><span class="n">Av</span><span class="o">/</span><span class="n">constant</span><span class="o">.</span><span class="n">cm_To_m</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Tsh</span>

    <span class="k">return</span> <span class="n">F</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="lyopronto.functions.sub_rate" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sub_rate</span><span class="p">(</span><span class="n">Ap</span><span class="p">,</span> <span class="n">Rp</span><span class="p">,</span> <span class="n">T_sub</span><span class="p">,</span> <span class="n">Pch</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Calculates the sublimation rate from each vial in kg/hr. Inputs are
product area in cm^2, product resistance in cm^2-Torr-hr/g, sublimation
front temperature in degC, and chamber pressure in Torr</p>


            <details class="quote">
              <summary>Source code in <code>lyopronto\functions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">sub_rate</span><span class="p">(</span><span class="n">Ap</span><span class="p">,</span><span class="n">Rp</span><span class="p">,</span><span class="n">T_sub</span><span class="p">,</span><span class="n">Pch</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the sublimation rate from each vial in kg/hr. Inputs are</span>
<span class="sd">    product area in cm^2, product resistance in cm^2-Torr-hr/g, sublimation</span>
<span class="sd">    front temperature in degC, and chamber pressure in Torr</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">P_sub</span> <span class="o">=</span> <span class="n">Vapor_pressure</span><span class="p">(</span><span class="n">T_sub</span><span class="p">)</span>   <span class="c1"># Vapor pressure at the sublimation temperature in Torr</span>

    <span class="n">dm_dt</span> <span class="o">=</span> <span class="n">Ap</span><span class="o">/</span><span class="n">Rp</span><span class="o">/</span><span class="n">constant</span><span class="o">.</span><span class="n">kg_To_g</span><span class="o">*</span><span class="p">(</span><span class="n">P_sub</span><span class="o">-</span><span class="n">Pch</span><span class="p">)</span>  <span class="c1"># Sublimation rate in kg/hr</span>

    <span class="k">return</span> <span class="n">dm_dt</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.92b07e13.min.js"></script>
      
    
  </body>
</html>