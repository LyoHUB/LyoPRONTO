
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../how-to-guides/">
      
      
        <link rel="next" href="../unknownRp_PD/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.18">
    
    
      
        <title>Simulate primary drying with known Kv and Rp - LyoPRONTO Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#simulate-primary-drying-with-known-kv-and-rp" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="LyoPRONTO Documentation" class="md-header__button md-logo" aria-label="LyoPRONTO Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LyoPRONTO Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Simulate primary drying with known Kv and Rp
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="LyoPRONTO Documentation" class="md-nav__button md-logo" aria-label="LyoPRONTO Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    LyoPRONTO Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LyoPRONTO: Getting Started
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorials
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how-to-guides/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    How-to Guide
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Simulate primary drying with known Kv and Rp
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Simulate primary drying with known Kv and Rp
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#lyopronto.calc_knownRp.dry" class="md-nav__link">
    <span class="md-ellipsis">
      dry
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../unknownRp_PD/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fitting Unknown Rp to Process Data
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../explanation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Explanations
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Full listing of all docstrings by module
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#lyopronto.calc_knownRp.dry" class="md-nav__link">
    <span class="md-ellipsis">
      dry
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="simulate-primary-drying-with-known-kv-and-rp">Simulate primary drying with known Kv and Rp</h1>
<p>Since this documentation example is a Jupyter notebook, inside the LyoPRONTO file structure, it needs to be directed to the LyoPRONTO code, which means adding <code>../../</code> to <code>sys.path</code>.
However, this step will in general not be necessary.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;../../&#39;</span><span class="p">)</span>
</code></pre></div>
<p>We need a few imports:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">rc</span> <span class="k">as</span> <span class="n">matplotlibrc</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ruamel.yaml</span><span class="w"> </span><span class="kn">import</span> <span class="n">YAML</span>
<span class="n">yaml</span> <span class="o">=</span> <span class="n">YAML</span><span class="p">()</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">lyopronto</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">lp</span>
</code></pre></div>
<p>Then, we provide all the necessary simulation parameters.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Set up the simulation settings</span>
<span class="c1"># This needs to be a dict with string keys, which can be expressed in YAML as well</span>
<span class="n">sim</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">tool: Primary Drying Calculator</span>
<span class="s2">Kv_known: Y</span>
<span class="s2">Rp_known: Y</span>
<span class="s2">Variable_Pch: N</span>
<span class="s2">Variable_Tsh: N</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
<span class="c1"># Or, equivalently:</span>
<span class="n">sim</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;tool&#39;</span><span class="p">:</span><span class="s1">&#39;Primary Drying Calculator&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Kv_known&#39;</span><span class="p">:</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Rp_known&#39;</span><span class="p">:</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Variable_Pch&#39;</span><span class="p">:</span><span class="s1">&#39;N&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Variable_Tsh&#39;</span><span class="p">:</span><span class="s1">&#39;N&#39;</span><span class="p">}</span>


<span class="c1"># Vial and fill properties</span>
<span class="n">vial</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># Av = Vial area in cm^2</span>
    <span class="s1">&#39;Av&#39;</span><span class="p">:</span> <span class="mf">3.80</span><span class="p">,</span>
    <span class="c1"># Ap = Product Area in cm^2</span>
    <span class="s1">&#39;Ap&#39;</span><span class="p">:</span> <span class="mf">3.14</span><span class="p">,</span>
    <span class="c1"># Vfill = Fill volume in mL</span>
    <span class="s1">&#39;Vfill&#39;</span><span class="p">:</span> <span class="mf">2.0</span>
<span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Product properties</span>
<span class="n">product</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># cSolid = Fractional concentration of solute in the frozen solution</span>
    <span class="s1">&#39;cSolid&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span>
    <span class="c1"># Product Resistance Parameters</span>
    <span class="s1">&#39;R0&#39;</span><span class="p">:</span> <span class="mf">1.4</span><span class="p">,</span> <span class="c1"># cm^2-hr-Torr/g</span>
    <span class="s1">&#39;A1&#39;</span><span class="p">:</span> <span class="mf">16.0</span><span class="p">,</span> <span class="c1"># cm-hr-Torr/g</span>
    <span class="s1">&#39;A2&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="c1"># 1/cm</span>
    <span class="c1"># Critical product temperature</span>
    <span class="c1"># At least 2 to 3 deg C below collapse or glass transition temperature</span>
    <span class="s1">&#39;T_pr_crit&#39;</span><span class="p">:</span> <span class="o">-</span> <span class="mi">5</span> <span class="c1"># in deg C</span>
<span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Vial Heat Transfer Parameters</span>
<span class="n">ht</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;KC&#39;</span><span class="p">:</span> <span class="mf">2.75e-4</span><span class="p">,</span> <span class="c1"># cal/s-cm^2-K</span>
    <span class="s1">&#39;KP&#39;</span><span class="p">:</span> <span class="mf">8.93e-4</span><span class="p">,</span> <span class="c1"># cal/s-cm^2-K-Torr</span>
    <span class="s1">&#39;KD&#39;</span><span class="p">:</span> <span class="mf">0.46</span>     <span class="c1"># 1/Torr</span>
<span class="p">}</span>

<span class="c1"># Chamber Pressure</span>
<span class="n">Pchamber</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># setpt = Chamber pressure set points in Torr</span>
    <span class="s1">&#39;setpt&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.15</span><span class="p">],</span>
    <span class="c1"># dt_setpt = Time for which chamber pressure set points are held in min</span>
    <span class="s1">&#39;dt_setpt&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1800.0</span><span class="p">],</span>
    <span class="c1"># ramp_rate = Chamber pressure ramping rate in Torr/min</span>
    <span class="s1">&#39;ramp_rate&#39;</span><span class="p">:</span> <span class="mf">0.5</span>
<span class="p">}</span>

<span class="n">Tshelf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># init = Intial shelf temperature in C</span>
    <span class="s1">&#39;init&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">35.0</span><span class="p">,</span>
    <span class="c1"># setpt = Shelf temperature set points in C</span>
    <span class="s1">&#39;setpt&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">20.0</span><span class="p">],</span>
    <span class="c1"># dt_setpt = Time for which shelf temperature set points are held in min</span>
    <span class="s1">&#39;dt_setpt&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1800.0</span><span class="p">],</span>
    <span class="c1"># ramp_rate = Shelf temperature ramping rate in C/min</span>
    <span class="s1">&#39;ramp_rate&#39;</span><span class="p">:</span> <span class="mf">1.0</span>
<span class="p">}</span>

<span class="c1"># Time step</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.01</span>    <span class="c1"># hr</span>
</code></pre></div>
<p>Now, we are ready to actually run the simulation, which is <code>lyopronto.calc_knownRp.dry</code>.</p>
<details class="info - documentation">
<summary>Info</summary>
<p><strong>Here is the documentation for that function:</strong>
</p>


<div class="doc doc-object doc-function">



<a id="lyopronto.calc_knownRp.dry"></a>
    <div class="doc doc-contents first">

        <p>Simulate the primary drying process for known condiditions and parameters.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>vial</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>see master simulation inputs</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>product</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>see master simulation inputs</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ht</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>see master simulation inputs</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>Pchamber</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>see master simulation inputs</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>Tshelf</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>see master simulation inputs</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dt</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Fixed time step for output [hours]</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>output_table</code></td>            <td>
                  <code><span title="ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Simulation output table with columns for:
0. Time [hr],
1. Sublimation front temperature [°C],
2. Vial bottom temperature [°C],
3. Shelf temperature [°C],
4. Chamber pressure [mTorr],
5. Sublimation flux [kg/hr/m²],
6. Drying fraction [-]</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>lyopronto\calc_knownRp.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">dry</span><span class="p">(</span><span class="n">vial</span><span class="p">,</span><span class="n">product</span><span class="p">,</span><span class="n">ht</span><span class="p">,</span><span class="n">Pchamber</span><span class="p">,</span><span class="n">Tshelf</span><span class="p">,</span><span class="n">dt</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Simulate the primary drying process for known condiditions and parameters.</span>

<span class="sd">    Args:</span>
<span class="sd">        vial (dict): see master simulation inputs</span>
<span class="sd">        product (dict): see master simulation inputs</span>
<span class="sd">        ht (dict): see master simulation inputs</span>
<span class="sd">        Pchamber (dict): see master simulation inputs</span>
<span class="sd">        Tshelf (dict): see master simulation inputs</span>
<span class="sd">        dt (float): Fixed time step for output [hours]</span>

<span class="sd">    Returns:</span>
<span class="sd">        output_table (ndarray): Simulation output table with columns for:</span>
<span class="sd">            0. Time [hr],</span>
<span class="sd">            1. Sublimation front temperature [°C],</span>
<span class="sd">            2. Vial bottom temperature [°C],</span>
<span class="sd">            3. Shelf temperature [°C],</span>
<span class="sd">            4. Chamber pressure [mTorr],</span>
<span class="sd">            5. Sublimation flux [kg/hr/m²],</span>
<span class="sd">            6. Drying fraction [-]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">##################  Initialization ################</span>

    <span class="c1"># Initial fill height</span>
    <span class="n">Lpr0</span> <span class="o">=</span> <span class="n">functions</span><span class="o">.</span><span class="n">Lpr0_FUN</span><span class="p">(</span><span class="n">vial</span><span class="p">[</span><span class="s1">&#39;Vfill&#39;</span><span class="p">],</span><span class="n">vial</span><span class="p">[</span><span class="s1">&#39;Ap&#39;</span><span class="p">],</span><span class="n">product</span><span class="p">[</span><span class="s1">&#39;cSolid&#39;</span><span class="p">])</span>   <span class="c1"># cm</span>

    <span class="n">Pch_t</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">Pchamber</span><span class="p">[</span><span class="s1">&#39;setpt&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># TODO: allow ramps</span>
    <span class="n">Tsh_t</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="nb">min</span><span class="p">(</span><span class="n">Tshelf</span><span class="p">[</span><span class="s1">&#39;setpt&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">t</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="n">Tshelf</span><span class="p">[</span><span class="s1">&#39;ramp_rate&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">Tshelf</span><span class="p">[</span><span class="s1">&#39;init&#39;</span><span class="p">])</span>

    <span class="n">config</span> <span class="o">=</span> <span class="p">(</span><span class="n">vial</span><span class="p">,</span> <span class="n">product</span><span class="p">,</span> <span class="n">ht</span><span class="p">,</span> <span class="n">Pch_t</span><span class="p">,</span> <span class="n">Tsh_t</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">Lpr0</span><span class="p">)</span>

    <span class="n">Lck0</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span>
    <span class="n">T0</span> <span class="o">=</span> <span class="n">Tsh_t</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1">################ Set up dynamic equation ######################</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">calc_dLdt</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">u</span><span class="p">):</span>
        <span class="n">Lck</span> <span class="o">=</span> <span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Tsh</span> <span class="o">=</span> <span class="n">Tsh_t</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="n">Pch</span> <span class="o">=</span> <span class="n">Pch_t</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="n">Kv</span> <span class="o">=</span> <span class="n">functions</span><span class="o">.</span><span class="n">Kv_FUN</span><span class="p">(</span><span class="n">ht</span><span class="p">[</span><span class="s1">&#39;KC&#39;</span><span class="p">],</span><span class="n">ht</span><span class="p">[</span><span class="s1">&#39;KP&#39;</span><span class="p">],</span><span class="n">ht</span><span class="p">[</span><span class="s1">&#39;KD&#39;</span><span class="p">],</span><span class="n">Pch</span><span class="p">)</span>  <span class="c1"># Vial heat transfer coefficient in cal/s/K/cm^2</span>
        <span class="n">Rp</span> <span class="o">=</span> <span class="n">functions</span><span class="o">.</span><span class="n">Rp_FUN</span><span class="p">(</span><span class="n">Lck</span><span class="p">,</span><span class="n">product</span><span class="p">[</span><span class="s1">&#39;R0&#39;</span><span class="p">],</span><span class="n">product</span><span class="p">[</span><span class="s1">&#39;A1&#39;</span><span class="p">],</span><span class="n">product</span><span class="p">[</span><span class="s1">&#39;A2&#39;</span><span class="p">])</span>  <span class="c1"># Product resistance in cm^2-hr-Torr/g</span>
        <span class="n">Tsub</span> <span class="o">=</span> <span class="n">fsolve</span><span class="p">(</span><span class="n">functions</span><span class="o">.</span><span class="n">T_sub_solver_FUN</span><span class="p">,</span> <span class="n">T0</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">Pch</span><span class="p">,</span><span class="n">vial</span><span class="p">[</span><span class="s1">&#39;Av&#39;</span><span class="p">],</span><span class="n">vial</span><span class="p">[</span><span class="s1">&#39;Ap&#39;</span><span class="p">],</span><span class="n">Kv</span><span class="p">,</span><span class="n">Lpr0</span><span class="p">,</span><span class="n">Lck</span><span class="p">,</span><span class="n">Rp</span><span class="p">,</span><span class="n">Tsh</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># Sublimation front temperature array in degC</span>
        <span class="n">dmdt</span> <span class="o">=</span> <span class="n">functions</span><span class="o">.</span><span class="n">sub_rate</span><span class="p">(</span><span class="n">vial</span><span class="p">[</span><span class="s1">&#39;Ap&#39;</span><span class="p">],</span><span class="n">Rp</span><span class="p">,</span><span class="n">Tsub</span><span class="p">,</span><span class="n">Pch</span><span class="p">)</span>   <span class="c1"># Total sublimation rate array in kg/hr</span>
        <span class="k">if</span> <span class="n">dmdt</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="c1"># print(&quot;Shelf temperature is too low for sublimation.&quot;)</span>
            <span class="n">dmdt</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="n">dLdt</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">dLdt</span><span class="p">]</span>
        <span class="c1"># Tbot = functions.T_bot_FUN(Tsub,Lpr0,Lck,Pch,Rp)    # Vial bottom temperature array in degC</span>

        <span class="n">dLdt</span> <span class="o">=</span> <span class="p">(</span><span class="n">dmdt</span><span class="o">*</span><span class="n">constant</span><span class="o">.</span><span class="n">kg_To_g</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">product</span><span class="p">[</span><span class="s1">&#39;cSolid&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">constant</span><span class="o">.</span><span class="n">rho_solution</span><span class="o">/</span><span class="n">constant</span><span class="o">.</span><span class="n">rho_solute</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">vial</span><span class="p">[</span><span class="s1">&#39;Ap&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">constant</span><span class="o">.</span><span class="n">rho_ice</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">product</span><span class="p">[</span><span class="s1">&#39;cSolid&#39;</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">constant</span><span class="o">.</span><span class="n">rho_solution</span><span class="o">-</span><span class="n">constant</span><span class="o">.</span><span class="n">rho_ice</span><span class="p">)</span><span class="o">/</span><span class="n">constant</span><span class="o">.</span><span class="n">rho_solute</span><span class="p">)</span> <span class="c1"># cm</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">dLdt</span><span class="p">]</span>

    <span class="c1">### ------ Condition for ending simulation: completed drying</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">finish</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">L</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Lpr0</span> <span class="o">-</span> <span class="n">L</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">finish</span><span class="o">.</span><span class="n">terminal</span> <span class="o">=</span> <span class="kc">True</span>


    <span class="c1"># ------- Solve the equations</span>
    <span class="n">sol</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">calc_dLdt</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">24</span><span class="o">*</span><span class="mi">3600</span><span class="o">*</span><span class="mi">14</span><span class="p">),</span> <span class="n">Lck0</span><span class="p">,</span> <span class="n">events</span><span class="o">=</span><span class="n">finish</span><span class="p">,</span> 
                    <span class="n">vectorized</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dense_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;BDF&quot;</span><span class="p">)</span>

    <span class="n">output</span> <span class="o">=</span> <span class="n">functions</span><span class="o">.</span><span class="n">fill_output</span><span class="p">(</span><span class="n">sol</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">output</span>    
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div></details>
<div class="highlight"><pre><span></span><code><span class="n">output_table</span> <span class="o">=</span> <span class="n">lp</span><span class="o">.</span><span class="n">calc_knownRp</span><span class="o">.</span><span class="n">dry</span><span class="p">(</span><span class="n">vial</span><span class="p">,</span><span class="n">product</span><span class="p">,</span><span class="n">ht</span><span class="p">,</span><span class="n">Pchamber</span><span class="p">,</span><span class="n">Tshelf</span><span class="p">,</span><span class="n">dt</span><span class="p">)</span>
</code></pre></div>
<p>It's a good idea, particularly when you are exploring interactively, to write the simulation input and output to disk together so that as you do later analysis, you have a record of what you did. Uncommenting the following code will do so.</p>
<p>Previously the inputs were recorded as a two-column CSV, which records info but isn't very readable (and frankly not very useful to a machine either). YAML provides a somewhat more sensible format, and fortunately a Python dictionary can be readily represented in YAML.</p>
<div class="highlight"><pre><span></span><code><span class="n">sim_setup</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;sim&#39;</span><span class="p">:</span> <span class="n">sim</span><span class="p">,</span>
    <span class="s1">&#39;vial&#39;</span><span class="p">:</span> <span class="n">vial</span><span class="p">,</span>
    <span class="s1">&#39;product&#39;</span><span class="p">:</span> <span class="n">product</span><span class="p">,</span>
    <span class="s1">&#39;ht&#39;</span><span class="p">:</span> <span class="n">ht</span><span class="p">,</span>
    <span class="s1">&#39;Pchamber&#39;</span><span class="p">:</span> <span class="n">Pchamber</span><span class="p">,</span>
    <span class="s1">&#39;Tshelf&#39;</span><span class="p">:</span> <span class="n">Tshelf</span><span class="p">,</span>
    <span class="s1">&#39;dt&#39;</span><span class="p">:</span> <span class="n">dt</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># # Write input data to disk as YAML</span>
<span class="c1"># import time</span>
<span class="c1"># current_time = time.strftime(&quot;%Y%m%d_%H%M%S&quot;)</span>
<span class="c1"># try:</span>
<span class="c1">#     yamlfile = open(&#39;lyopronto_input_&#39;+current_time+&#39;.yaml&#39;, &#39;w&#39;)</span>
<span class="c1">#     yaml.dump(sim_setup, yamlfile)</span>
<span class="c1"># finally:</span>
<span class="c1">#     yamlfile.close()</span>

<span class="c1"># # Write simulation data to disk as CSV</span>
<span class="c1"># try:</span>
<span class="c1">#     csvfile = open(&#39;lyopronto_output_&#39;+current_time+&#39;.csv&#39;, &#39;w&#39;)</span>
<span class="c1">#     writer = csv.writer(csvfile)</span>
<span class="c1">#     writer.writerow([&#39;Time [hr]&#39;,&#39;Sublimation Temperature [C]&#39;,&#39;Vial Bottom Temperature [C]&#39;, &#39;Shelf Temperature [C]&#39;,&#39;Chamber Pressure [mTorr]&#39;,&#39;Sublimation Flux [kg/hr/m^2]&#39;,&#39;Percent Dried&#39;])</span>
<span class="c1">#     for i in range(0,len(output_table)):</span>
<span class="c1">#         writer.writerow(output_table[i])</span>
<span class="c1"># finally:</span>
<span class="c1">#     csvfile.close()</span>
</code></pre></div>
<p>Finally, it's a good idea to plot everything. Here, again, you could save plots to disk by uncommenting the lines below.</p>
<p>Some default styling of the axes is carried out with <code>lyopronto.plot_styling.axis_style_*</code>, like turning on minor ticks and setting tick labels to be bold. However, this is entirely up to aesthetic taste and leaving it out does not affect the basic logic of the plots.</p>
<div class="highlight"><pre><span></span><code><span class="n">matplotlibrc</span><span class="p">(</span><span class="s1">&#39;text.latex&#39;</span><span class="p">,</span> <span class="n">preamble</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;\usepackage</span><span class="si">{color}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">matplotlibrc</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">,</span><span class="n">usetex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.family&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Arial&#39;</span>

<span class="n">figwidth</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">figheight</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">lineWidth</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">markerSize</span> <span class="o">=</span> <span class="mi">20</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">figwidth</span><span class="p">,</span><span class="n">figheight</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">output_table</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">output_table</span><span class="p">[:,</span><span class="mi">4</span><span class="p">],</span><span class="s1">&#39;-o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">markevery</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="n">lineWidth</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">markerSize</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Chamber Pressure&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">output_table</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">output_table</span><span class="p">[:,</span><span class="mi">5</span><span class="p">],</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.3</span><span class="p">],</span><span class="n">linewidth</span><span class="o">=</span><span class="n">lineWidth</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Sublimation Flux&quot;</span><span class="p">)</span>

<span class="n">lp</span><span class="o">.</span><span class="n">plot_styling</span><span class="o">.</span><span class="n">axis_style_pressure</span><span class="p">(</span><span class="n">ax1</span><span class="p">)</span>
<span class="n">lp</span><span class="o">.</span><span class="n">plot_styling</span><span class="o">.</span><span class="n">axis_style_subflux</span><span class="p">(</span><span class="n">ax2</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="c1"># figure_name = &#39;lyopronto_pressure_subflux_&#39;+current_time+&#39;.pdf&#39;</span>
<span class="c1"># plt.savefig(figure_name)</span>
<span class="c1"># plt.close()</span>
</code></pre></div>
<p><img alt="img" src="../_data/b6bef4e322cf487d91451b62e2050601.png" /></p>
<div class="highlight"><pre><span></span><code><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">figwidth</span><span class="p">,</span><span class="n">figheight</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">lp</span><span class="o">.</span><span class="n">plot_styling</span><span class="o">.</span><span class="n">axis_style_percdried</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">output_table</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">output_table</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;-k&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="n">lineWidth</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Percent Dried&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="c1"># figure_name = &#39;lyopronto_percentdried_&#39;+current_time+&#39;.pdf&#39;</span>
<span class="c1"># plt.savefig(figure_name)</span>
<span class="c1"># plt.close()</span>
</code></pre></div>
<p><img alt="img" src="../_data/5a555bf88eeb455987afcb0abf7563dd.png" /></p>
<div class="highlight"><pre><span></span><code><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">figwidth</span><span class="p">,</span><span class="n">figheight</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">lp</span><span class="o">.</span><span class="n">plot_styling</span><span class="o">.</span><span class="n">axis_style_temperature</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">output_table</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">output_table</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;-b&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="n">lineWidth</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Sublimation Front Temperature&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">output_table</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">output_table</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span><span class="s1">&#39;-r&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="n">lineWidth</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Maximum Product Temperature&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">output_table</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">output_table</span><span class="p">[:,</span><span class="mi">3</span><span class="p">],</span><span class="s1">&#39;-o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">markevery</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="n">lineWidth</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">markerSize</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Shelf Temperature&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">ll</span><span class="p">,</span><span class="n">ul</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">ll</span><span class="p">,</span><span class="n">ul</span><span class="o">+</span><span class="mf">5.0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="c1"># figure_name = &#39;lyopronto_temperatures_&#39;+current_time+&#39;.pdf&#39;</span>
<span class="c1"># plt.savefig(figure_name)</span>
<span class="c1"># plt.close()</span>
</code></pre></div>
<p><img alt="img" src="../_data/85a88a04b9cd44dbb44d7e7b747f3b93.png" /></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.92b07e13.min.js"></script>
      
    
  </body>
</html>